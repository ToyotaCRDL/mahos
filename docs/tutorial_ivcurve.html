
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial 2: Basic Measurement &#8212; MAHOS 0.2.3 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial_ivcurve';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial 3: Manual Operation" href="tutorial_manual_op.html" />
    <link rel="prev" title="Tutorial 1: Communication" href="tutorial_comm.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">MAHOS 0.2.3 documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="overview.html">
                        Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="installation.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="tutorial.html">
                        Tutorial
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="arch.html">
                        Architecture
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="conf.html">
                        Configuration file
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="cli.html">
                        Command Line Interface
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contributing.html">
                        Contributing to MAHOS
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="glossary.html">
                        Glossary
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="overview.html">
                        Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="installation.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="tutorial.html">
                        Tutorial
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="arch.html">
                        Architecture
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="conf.html">
                        Configuration file
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="cli.html">
                        Command Line Interface
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contributing.html">
                        Contributing to MAHOS
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="glossary.html">
                        Glossary
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="tutorial_comm.html">Tutorial 1: Communication</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Tutorial 2: Basic Measurement</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_manual_op.html">Tutorial 3: Manual Operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_next_steps.html">Tutorial: Next Steps</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="tutorial.html" class="nav-link">Tutorial</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Tutorial 2: Basic Measurement</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="tutorial-2-basic-measurement">
<h1>Tutorial 2: Basic Measurement<a class="headerlink" href="#tutorial-2-basic-measurement" title="Permalink to this heading">#</a></h1>
<p>In this tutorial chapter, we will learn how basic measurement system is constructed on mahos
(with mock instruments).</p>
<section id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Permalink to this heading">#</a></h2>
<p>Before starting this, <a class="reference internal" href="installation.html"><span class="doc">install</span></a> the library and dependencies.</p>
<p>It is recommended to finish <a class="reference internal" href="tutorial_comm.html"><span class="doc">Tutorial 1: Communication</span></a> before this.</p>
<p>Find the <code class="docutils literal notranslate"><span class="pre">examples/ivcurve</span></code> directory in the mahos repository.
We will use the files in it for this tutorial.
You can copy this directory to somewhere in your computer if you want.</p>
</section>
<section id="running-the-mock">
<h2>Running the mock<a class="headerlink" href="#running-the-mock" title="Permalink to this heading">#</a></h2>
<p>Run all the nodes defined in our <code class="docutils literal notranslate"><span class="pre">conf.toml</span></code> by command <code class="docutils literal notranslate"><span class="pre">mahos</span> <span class="pre">launch</span></code>.
You will see a GUI window popping out.
If you click the Start button, some noisy line (IV curve) is plotted and updated.
This is our mock for IV curve measurement.</p>
<p>The IV curve measurement is illustrated by the figure below.
We have two instruments <cite>source</cite> (Voltage Source) and <cite>meter</cite> (Current meter) to
measure IV characteristics of DUT (Device Under Test).</p>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/ivcurve-sch.svg"><img alt="Schematic of IV curve measurement" src="_images/ivcurve-sch.svg" width="50%" /></a>
<figcaption>
<p><span class="caption-text">Schematic of IV curve measurement</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="visualizing-config">
<h2>Visualizing config<a class="headerlink" href="#visualizing-config" title="Permalink to this heading">#</a></h2>
<p>Let’s analyze below what’s happening behind the scenes.
First, try visualizing our nodes by <code class="docutils literal notranslate"><span class="pre">mahos</span> <span class="pre">graph</span></code>, and you will see a graph below.</p>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="_images/ivcurve-nodes.svg"><img alt="Node graph for IV curve" src="_images/ivcurve-nodes.svg" width="30%" /></a>
<figcaption>
<p><span class="caption-text">Node graph for IV curve</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>As visualized, the config file defines four nodes.
We will go through these from bottom to top (from top to bottom in <code class="docutils literal notranslate"><span class="pre">conf.toml</span></code>).</p>
<p>The topmost group in <code class="docutils literal notranslate"><span class="pre">conf.toml</span></code> is named <cite>global</cite>.
This is special group to define the default value for all the nodes.
If the same key is defined for a node, the global value is just ignored.
Otherwise, the global value is used.
(The behaviour is similar to local and global variable in some programming languages.)</p>
</section>
<section id="log">
<h2>log<a class="headerlink" href="#log" title="Permalink to this heading">#</a></h2>
<p>The second group is named <cite>localhost.log</cite>.
It is important to observe the log messages for the debugging or monitoring.
Since mahos adopted a distributed system,
the sources of logs (i.e., <a class="reference internal" href="glossary.html#term-node"><span class="xref std std-term">nodes</span></a>) are running on multiple processes.
In order to sort out the distributed logs, it seems good to gather the logs to single node,
and then redistribute.
The <a class="reference internal" href="node/generated/mahos.node.log_broker.LogBroker.html#mahos.node.log_broker.LogBroker" title="mahos.node.log_broker.LogBroker"><code class="xref py py-class docutils literal notranslate"><span class="pre">LogBroker</span></code></a> is implemented for this purpose.</p>
<p>It is highly recommended to define a <cite>log</cite> in <code class="docutils literal notranslate"><span class="pre">conf.toml</span></code>, as in the file for this tutorial.
You can see arrows labeled <cite>log</cite> are coming from <cite>server</cite> and <cite>ivcurve</cite> to the <cite>log</cite> node in the graph.
These arrows are corresponding to Line 15 and Line 37-38 in <code class="docutils literal notranslate"><span class="pre">conf.toml</span></code>.</p>
<p>(In <a class="reference internal" href="tutorial_comm.html"><span class="doc">Tutorial 1: Communication</span></a>, we have omitted this and used dummy loggers.)</p>
</section>
<section id="server">
<h2>server<a class="headerlink" href="#server" title="Permalink to this heading">#</a></h2>
<p>The <cite>server</cite> (<a class="reference internal" href="inst/generated/mahos.inst.server.InstrumentServer.html#mahos.inst.server.InstrumentServer" title="mahos.inst.server.InstrumentServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">InstrumentServer</span></code></a>) is defined as below.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">conf.toml</span><a class="headerlink" href="#id4" title="Permalink to this code">#</a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="linenos">12</span><span class="k">[localhost.server]</span>
<span class="linenos">13</span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;mahos.inst.server&quot;</span>
<span class="linenos">14</span><span class="n">class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;InstrumentServer&quot;</span>
<span class="linenos">15</span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;localhost::log&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">16</span><span class="n">log_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;DEBUG&quot;</span>
<span class="linenos">17</span><span class="n">rep_endpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tcp://127.0.0.1:5559&quot;</span>
<span class="linenos">18</span><span class="n">pub_endpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tcp://127.0.0.1:5560&quot;</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="k">[localhost.server.instrument.source]</span>
<span class="linenos">21</span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;instruments&quot;</span>
<span class="linenos">22</span><span class="n">class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;VoltageSource_mock&quot;</span>
<span class="linenos">23</span><span class="k">[localhost.server.instrument.source.conf]</span>
<span class="linenos">24</span><span class="n">resource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;VISA::DUMMY0&quot;</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="k">[localhost.server.instrument.meter]</span>
<span class="linenos">27</span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;instruments&quot;</span>
<span class="linenos">28</span><span class="n">class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Multimeter_mock&quot;</span>
<span class="linenos">29</span><span class="k">[localhost.server.instrument.meter.conf]</span>
<span class="linenos">30</span><span class="n">resource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;VISA::DUMMY1&quot;</span>
</pre></div>
</div>
</div>
<p><a class="reference internal" href="inst/generated/mahos.inst.server.InstrumentServer.html#mahos.inst.server.InstrumentServer" title="mahos.inst.server.InstrumentServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">InstrumentServer</span></code></a> is the node for <a class="reference internal" href="arch_inst.html"><span class="doc">inst layer</span></a> to provide <a class="reference internal" href="glossary.html#term-RPC"><span class="xref std std-term">RPC</span></a> for instrument drivers.
Thus, you don’t need to write a <a class="reference internal" href="glossary.html#term-node"><span class="xref std std-term">node</span></a> for this purpose; you write instrument driver classes (<a class="reference internal" href="inst/Instrument.html#mahos.inst.instrument.Instrument" title="mahos.inst.instrument.Instrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></a>) instead.
The second group above <code class="docutils literal notranslate"><span class="pre">[localhost.server.instrument.source]</span></code> defines
an instrument <cite>source</cite> inside the <cite>server</cite>.
The <cite>VoltageSource_mock</cite> is an example of <a class="reference internal" href="inst/Instrument.html#mahos.inst.instrument.Instrument" title="mahos.inst.instrument.Instrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></a> class here.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">instruments.py</span><a class="headerlink" href="#id5" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 9</span><span class="k">class</span> <span class="nc">VoltageSource_mock</span><span class="p">(</span><span class="n">Instrument</span><span class="p">):</span>
<span class="linenos">10</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">conf</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="linenos">11</span>        <span class="n">Instrument</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">conf</span><span class="o">=</span><span class="n">conf</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">)</span>
<span class="linenos">12</span>
<span class="linenos">13</span>        <span class="bp">self</span><span class="o">.</span><span class="n">check_required_conf</span><span class="p">([</span><span class="s2">&quot;resource&quot;</span><span class="p">])</span>
<span class="linenos">14</span>        <span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conf</span><span class="p">[</span><span class="s2">&quot;resource&quot;</span><span class="p">]</span>
<span class="linenos">15</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Open VoltageSource at </span><span class="si">{</span><span class="n">resource</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="linenos">17</span>    <span class="k">def</span> <span class="nf">set_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="linenos">18</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Set output &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;on&quot;</span> <span class="k">if</span> <span class="n">on</span> <span class="k">else</span> <span class="s2">&quot;off&quot;</span><span class="p">))</span>
<span class="linenos">19</span>        <span class="k">return</span> <span class="kc">True</span>
<span class="linenos">20</span>
<span class="linenos">21</span>    <span class="k">def</span> <span class="nf">set_voltage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">volt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="linenos">22</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dummy voltage </span><span class="si">{</span><span class="n">volt</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> V&quot;</span><span class="p">)</span>
<span class="linenos">23</span>        <span class="k">return</span> <span class="kc">True</span>
<span class="linenos">24</span>
<span class="linenos">25</span>    <span class="c1"># Standard API</span>
<span class="linenos">26</span>
<span class="linenos">27</span>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="linenos">28</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_output</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">29</span>
<span class="linenos">30</span>    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="linenos">31</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_output</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">32</span>
<span class="linenos">33</span>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="linenos">34</span>        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;volt&quot;</span><span class="p">:</span>
<span class="linenos">35</span>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_voltage</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="linenos">36</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">37</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown set() key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">38</span>            <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
<p>As the name suggests, this class is just a mock and doesn’t consume any external resources.
However, a real instrument usually requires a resource identifier for communication (VISA resource, IP Address, DLL path, etc.), and we have included how to pass such a configuration to an Instrument.
We define a configuration dictionary (<a class="reference internal" href="glossary.html#term-conf"><span class="xref std std-term">conf</span></a>) as Line 23-24 in <code class="docutils literal notranslate"><span class="pre">conf.toml</span></code>.
This is passed to Instrument and referred by <code class="docutils literal notranslate"><span class="pre">self.conf</span></code> (Line 14).
Line 13 uses a utility method to check existence of required key.</p>
<p>Only two functions of voltage source are implemented: <code class="docutils literal notranslate"><span class="pre">set_output()</span></code> and <code class="docutils literal notranslate"><span class="pre">set_voltage()</span></code>.
Meanings of these may be obvious.
We assume an output relay for voltage source, that is turned on/off by <code class="docutils literal notranslate"><span class="pre">set_output()</span></code>.
The output voltage can be set by <code class="docutils literal notranslate"><span class="pre">set_voltage()</span></code>.</p>
<p>Line 27 and below makes these adapted to the <a class="reference internal" href="inst/Instrument.html#instrument-api"><span class="std std-ref">Standard Instrument APIs</span></a>.
The <code class="docutils literal notranslate"><span class="pre">set_output()</span></code> is wrapped by <a class="reference internal" href="inst/Instrument.html#mahos.inst.instrument.Instrument.start" title="mahos.inst.instrument.Instrument.start"><code class="xref py py-meth docutils literal notranslate"><span class="pre">start</span></code></a> and <a class="reference internal" href="inst/Instrument.html#mahos.inst.instrument.Instrument.stop" title="mahos.inst.instrument.Instrument.stop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">stop</span></code></a>.
And <code class="docutils literal notranslate"><span class="pre">set_voltage()</span></code> is by <a class="reference internal" href="inst/Instrument.html#mahos.inst.instrument.Instrument.set" title="mahos.inst.instrument.Instrument.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set</span></code></a>.
Note that most of the <a class="reference internal" href="inst/Instrument.html#instrument-api"><span class="std std-ref">Standard Instrument APIs</span></a> (excepting <a class="reference internal" href="inst/Instrument.html#mahos.inst.instrument.Instrument.get" title="mahos.inst.instrument.Instrument.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get</span></code></a>) must return bool (True on success).</p>
<p>In <a class="reference internal" href="inst/Instrument.html#instrument-api"><span class="std std-ref">Standard Instrument APIs</span></a>, <a class="reference internal" href="inst/Instrument.html#mahos.inst.instrument.Instrument.set" title="mahos.inst.instrument.Instrument.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set</span></code></a>, <a class="reference internal" href="inst/Instrument.html#mahos.inst.instrument.Instrument.get" title="mahos.inst.instrument.Instrument.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get</span></code></a>, and <a class="reference internal" href="inst/Instrument.html#mahos.inst.instrument.Instrument.configure" title="mahos.inst.instrument.Instrument.configure"><code class="xref py py-meth docutils literal notranslate"><span class="pre">configure</span></code></a> accept some arguments and the type information of the arguments are lost (function signature of e.g. <code class="docutils literal notranslate"><span class="pre">set_voltage()</span></code> cannot be seen from the client).
We can define <a class="reference internal" href="inst/InstrumentInterface.html#mahos.inst.interface.InstrumentInterface" title="mahos.inst.interface.InstrumentInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">InstrumentInterface</span></code></a> to recover this, as below.
This procedure looks like a duplication of effort, but the positive side is that
we can define an explicit interface (which method is exported and which is not, as in static programming languages).</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">instruments.py</span><a class="headerlink" href="#id6" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">79</span><span class="k">class</span> <span class="nc">VoltageSourceInterface</span><span class="p">(</span><span class="n">InstrumentInterface</span><span class="p">):</span>
<span class="linenos">80</span>    <span class="k">def</span> <span class="nf">set_voltage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">volt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="linenos">81</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the output voltage.&quot;&quot;&quot;</span>
<span class="linenos">82</span>
<span class="linenos">83</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;volt&quot;</span><span class="p">,</span> <span class="n">volt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let’s interact with the server.
Launch <cite>server</cite> and <cite>log</cite> with <code class="docutils literal notranslate"><span class="pre">mahos</span> <span class="pre">launch</span> <span class="pre">log</span> <span class="pre">server</span></code>.
In the second terminal, <code class="docutils literal notranslate"><span class="pre">mahos</span> <span class="pre">log</span></code> to print the logs.
And <code class="docutils literal notranslate"><span class="pre">mahos</span> <span class="pre">shell</span> <span class="pre">server</span></code> to start IPython shell for server.</p>
<p>There are two ways to call the functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Method1: raw client calls</span>
<span class="n">cli</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">)</span>
<span class="n">cli</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="s2">&quot;volt&quot;</span><span class="p">,</span> <span class="mf">12.3</span><span class="p">)</span>

<span class="c1"># Method2: call through interface</span>
<span class="kn">from</span> <span class="nn">instruments</span> <span class="kn">import</span> <span class="n">VoltageSourceInterface</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">VoltageSouraceInterface</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">)</span>
<span class="n">source</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">source</span><span class="o">.</span><span class="n">set_voltage</span><span class="p">(</span><span class="mf">12.3</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="ivcurve">
<h2>ivcurve<a class="headerlink" href="#ivcurve" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ivcurve</span></code> is in the second layer (<a class="reference internal" href="arch_meas.html"><span class="doc">meas layer</span></a>): core measurement logic.
We have defined <code class="docutils literal notranslate"><span class="pre">ivcurve</span></code> in the config as below.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">conf.toml</span><a class="headerlink" href="#id7" title="Permalink to this code">#</a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="linenos">32</span><span class="k">[localhost.ivcurve]</span>
<span class="linenos">33</span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ivcurve&quot;</span>
<span class="linenos">34</span><span class="n">class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;IVCurve&quot;</span>
<span class="linenos">35</span><span class="n">rep_endpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tcp://127.0.0.1:5561&quot;</span>
<span class="linenos">36</span><span class="n">pub_endpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tcp://127.0.0.1:5562&quot;</span>
<span class="linenos">37</span><span class="k">[localhost.ivcurve.target]</span>
<span class="linenos">38</span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;localhost::log&quot;</span>
<span class="linenos">39</span><span class="k">[localhost.ivcurve.target.servers]</span>
<span class="linenos">40</span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;localhost::server&quot;</span>
<span class="linenos">41</span><span class="n">meter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;localhost::server&quot;</span>
</pre></div>
</div>
</div>
<p>Line 40-41 tells us that we need instruments <cite>source</cite> and <cite>meter</cite>
(both on <cite>localhost::server</cite>) for this measurement.</p>
<section id="operating-from-shell-or-script">
<h3>Operating from shell or script<a class="headerlink" href="#operating-from-shell-or-script" title="Permalink to this heading">#</a></h3>
<p>Before looking into the code, let’s run and interact with the ivcurve.
Launch nodes with <code class="docutils literal notranslate"><span class="pre">mahos</span> <span class="pre">launch</span> <span class="pre">log</span> <span class="pre">server</span> <span class="pre">ivcurve</span></code>.
In the second terminal, <code class="docutils literal notranslate"><span class="pre">mahos</span> <span class="pre">log</span></code> to print the logs.
And <code class="docutils literal notranslate"><span class="pre">mahos</span> <span class="pre">shell</span> <span class="pre">ivcurve</span></code> to start IPython shell for ivcurve.
The ivcurve measurement can be performed by following snippet.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">get_param_dict</span><span class="p">()</span>
<span class="n">cli</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="n">cli</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">get_data()</span></code> returns <code class="docutils literal notranslate"><span class="pre">IVCurveData</span></code> defined in <code class="docutils literal notranslate"><span class="pre">ivcurve_msgs.py</span></code>,
and <code class="docutils literal notranslate"><span class="pre">data.data</span></code> is the measurement result: a 2D numpy array of shape <cite>(number of voltage points (params[“num”]), number of sweeps)</cite>.</p>
<p>For a bit more meaningful application, try executing file <code class="docutils literal notranslate"><span class="pre">measure_and_plot.py</span></code> and understanding it.
<code class="docutils literal notranslate"><span class="pre">cli.get_param_dict()</span></code> returns a <a class="reference internal" href="msgs/param_msgs.html#param-dict"><span class="std std-ref">ParamDict</span></a>, str-keyed dict of <a class="reference internal" href="msgs/param_msgs.html#mahos.msgs.param_msgs.Param" title="mahos.msgs.param_msgs.Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">Param</span></code></a>.
<a class="reference internal" href="msgs/param_msgs.html#mahos.msgs.param_msgs.Param" title="mahos.msgs.param_msgs.Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">Param</span></code></a> is wrapper of basic (mostly builtin) types with default value, bounds (for int or float), etc.
You can set values of parameters by <a class="reference internal" href="msgs/param_msgs.html#mahos.msgs.param_msgs.Param.set" title="mahos.msgs.param_msgs.Param.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set()</span></code></a> and pass it to <code class="docutils literal notranslate"><span class="pre">cli.start()</span></code> as in <code class="docutils literal notranslate"><span class="pre">measure_and_plot.py</span></code>.</p>
</section>
<section id="reading-ivcurve-node">
<h3>Reading IVCurve node<a class="headerlink" href="#reading-ivcurve-node" title="Permalink to this heading">#</a></h3>
<p>What happens at ivcurve node side?
Look at implementation of <code class="docutils literal notranslate"><span class="pre">IVCurve</span></code> node in <code class="docutils literal notranslate"><span class="pre">ivcurve.py</span></code>.
<code class="docutils literal notranslate"><span class="pre">IVCurve</span></code> is subclass of <a class="reference internal" href="meas/generated/mahos.meas.common_meas.BasicMeasNode.html#mahos.meas.common_meas.BasicMeasNode" title="mahos.meas.common_meas.BasicMeasNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasicMeasNode</span></code></a>,
which is a convenient Node implementation for simple measurement nodes.
We explain how this node works by following <code class="docutils literal notranslate"><span class="pre">main()</span></code> method line by line.</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">ivcurve.py</span><a class="headerlink" href="#id8" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">172</span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">173</span>    <span class="bp">self</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
<span class="linenos">174</span>    <span class="n">publish_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_work</span><span class="p">()</span>
<span class="linenos">175</span>    <span class="bp">self</span><span class="o">.</span><span class="n">_check_finished</span><span class="p">()</span>
<span class="linenos">176</span>    <span class="bp">self</span><span class="o">.</span><span class="n">_publish</span><span class="p">(</span><span class="n">publish_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>First line of <code class="docutils literal notranslate"><span class="pre">main()</span></code> (Line 173) calls <code class="docutils literal notranslate"><span class="pre">poll()</span></code>.
Here, this node checks incoming requests, and if there is a request, the handler is called.
The handler is implemented in <a class="reference internal" href="meas/generated/mahos.meas.common_meas.BasicMeasNode.html#mahos.meas.common_meas.BasicMeasNode" title="mahos.meas.common_meas.BasicMeasNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasicMeasNode</span></code></a> (read the implementation if you are interested in) and it calls <code class="docutils literal notranslate"><span class="pre">change_state()</span></code> or <code class="docutils literal notranslate"><span class="pre">get_param_dict()</span></code> <a class="footnote-reference brackets" href="#f1" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> according to the request.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">cli.get_param_dict()</span></code> is called, request is sent to ivcurve and the result of <code class="docutils literal notranslate"><span class="pre">IVCurve.get_param_dict()</span></code> is returned.
The result of this method is hard-coded here; however, the parameter bounds may be determined by instruments for real application.</p>
<p>By observing <code class="docutils literal notranslate"><span class="pre">change_state()</span></code>, you will see that this node has explicit state: <code class="docutils literal notranslate"><span class="pre">BinaryState.IDLE</span></code> or <code class="docutils literal notranslate"><span class="pre">BinaryState.ACTIVE</span></code>.
All measurement nodes are advised to have explicit state like this, and BinaryState is the most simplest case.
<code class="docutils literal notranslate"><span class="pre">cli.start()</span></code> is a shorthand of <cite>change_state(ACTIVE)</cite>, and <code class="docutils literal notranslate"><span class="pre">cli.stop()</span></code> is <cite>change_state(IDLE)</cite>.
When state is changing from IDLE to ACTIVE, <code class="docutils literal notranslate"><span class="pre">self.sweeper.start()</span></code> is called.
<code class="docutils literal notranslate"><span class="pre">self.sweeper</span></code> is an instance of <code class="docutils literal notranslate"><span class="pre">Sweeper</span></code> class, that communicates with the server and do real jobs.</p>
<p>At the second line of <code class="docutils literal notranslate"><span class="pre">main()</span></code> (Line 174), through <code class="docutils literal notranslate"><span class="pre">_work()</span></code>, <code class="docutils literal notranslate"><span class="pre">self.sweeper.work()</span></code> is called.
A sweep measurement for IV curve is done there; <cite>source</cite> is used to apply voltage and the current is read by <cite>meter</cite>.</p>
<p>The third line of <code class="docutils literal notranslate"><span class="pre">main()</span></code> (Line 175) checks if we can finish the measurement.
Measurement is finished when <code class="docutils literal notranslate"><span class="pre">params[&quot;sweeps&quot;]</span></code> is positive and the sweeps have already been repeated <code class="docutils literal notranslate"><span class="pre">params[&quot;sweeps&quot;]</span></code> times (see <code class="docutils literal notranslate"><span class="pre">Sweeper.is_finished()</span></code>).</p>
<p>By final line of <code class="docutils literal notranslate"><span class="pre">main()</span></code> (Line 176), the node status and data are published.</p>
</section>
</section>
<section id="ivcurve-gui">
<h2>ivcurve_gui<a class="headerlink" href="#ivcurve-gui" title="Permalink to this heading">#</a></h2>
<p>The ivcurve_gui, a GUI frontend of ivcurve, is defined at the last group in <code class="docutils literal notranslate"><span class="pre">conf.toml</span></code>.
The class <code class="docutils literal notranslate"><span class="pre">IVCurveGUI</span></code> is in <code class="docutils literal notranslate"><span class="pre">ivcurve_gui.py</span></code>.
This is what we were operating in <a class="reference internal" href="#running-the-mock">Running the mock</a>.</p>
<p>Let’s launch all the nodes by <code class="docutils literal notranslate"><span class="pre">mahos</span> <span class="pre">launch</span></code> and confirm GUI is working.
Then, start the IPython shell with <code class="docutils literal notranslate"><span class="pre">mahos</span> <span class="pre">shell</span> <span class="pre">ivcurve</span></code> and send start or stop requests.
Furthermore, try running <code class="docutils literal notranslate"><span class="pre">measure_and_plot.py</span></code> script (stop the measurement before running).
It is quite important that we can operate the measurement from both the GUI and programs (shell, or a custom script).
This extensibility is one of the advantages of the distributed systems.</p>
<p>If you have experience in Qt (PyQt) programming, let’s take a look at <code class="docutils literal notranslate"><span class="pre">ivcurve_gui.py</span></code>.
The GUI component (IVCurveWidget) is composed quite simply by virtue of <code class="docutils literal notranslate"><span class="pre">QBasicMeasClient</span></code>.
This class is <cite>Qt-version</cite> of <cite>BasicMeasClient</cite> and emits Qt signal on reception of subscribed messages.
In other words, it translates MAHOS communication into Qt communication (signal-slot).
All we have to do for widget implementation is connecting the signals to slots updating the GUI state (Line 102-103) and sending requests (Line 124-136).</p>
<p>There is a bit special custom on initialization (<code class="docutils literal notranslate"><span class="pre">init_with_status()</span></code>).
We cannot initialize the GUI completely without the target node (<code class="docutils literal notranslate"><span class="pre">ivcurve</span></code>) because we have to know the target’s status (by <code class="docutils literal notranslate"><span class="pre">get_param_dict()</span></code> for example).
But we are not sure if the target node is up when GUI starts.
To assure this point, we first disable the widget (Line 29) and connect <cite>statusUpdate</cite> event to <code class="docutils literal notranslate"><span class="pre">init_with_status()</span></code> (Line 26).
When the first status message arrives, this method is fired and remaining initializations are done.
The widget is enabled finally at Line 105.
This method is called only once because the signal is disconnect at Line 79.</p>
</section>
<section id="overlay">
<h2>overlay<a class="headerlink" href="#overlay" title="Permalink to this heading">#</a></h2>
<p>TODO: explain overlay case <code class="docutils literal notranslate"><span class="pre">conf_overlay.toml</span></code>, <code class="docutils literal notranslate"><span class="pre">overlay.py</span></code>, and <code class="docutils literal notranslate"><span class="pre">ivcurve_overlay.py</span></code>.</p>
</section>
<section id="threading">
<h2>threading<a class="headerlink" href="#threading" title="Permalink to this heading">#</a></h2>
<p>TODO: explain threading case <code class="docutils literal notranslate"><span class="pre">conf_thread.toml</span></code> and <code class="docutils literal notranslate"><span class="pre">conf_thread_partial.toml</span></code>.</p>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="f1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>also calls <code class="docutils literal notranslate"><span class="pre">save_data()</span></code> etc. but omitted in this tutorial.</p>
</aside>
</aside>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="tutorial_comm.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial 1: Communication</p>
      </div>
    </a>
    <a class="right-next"
       href="tutorial_manual_op.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tutorial 3: Manual Operation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation">Preparation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-mock">Running the mock</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-config">Visualizing config</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#log">log</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#server">server</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ivcurve">ivcurve</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operating-from-shell-or-script">Operating from shell or script</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-ivcurve-node">Reading IVCurve node</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ivcurve-gui">ivcurve_gui</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overlay">overlay</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#threading">threading</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="_sources/tutorial_ivcurve.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2022, Toyota Central R&amp;D Labs., Inc.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>